#### DAY 37

#### 图像增广

##### 1.背景：

（1）⼤型数据集是成功应⽤深度神经⽹络的先决条件。

（2）图像增⼴在对训练图像进⾏⼀系 列的**随机变化**之后，⽣成**相似但不同**的训练样本，从⽽**扩⼤了训练集的规模。**

（3）应⽤图像增⼴的**原因**是， 随机改变训练样本可以**减少模型对某些属性的依赖**，从⽽**提⾼模型的泛化能⼒。**（eg：以不同的⽅式**裁剪**图像，使感兴趣的对象出现在不同的位置，减少模型对于对象出现**位置的依赖**；调整**亮度**、 颜⾊等因素来降低模型**对颜⾊的敏感度**。）

2.apply的实现

```python
#aup：各种transform方法
def apply(img, aug, num_rows=2, num_cols=4, scale=1.5):
    Y = [aug(img) for _ in range(num_rows * num_cols)]
    d2l.show_images(Y, num_rows, num_cols, scale=scale)
    d2l.plt.show()
```

<br>

##### 多种图像增广方法结合：

![image-20221127195210927](C:\Users\china\AppData\Roaming\Typora\typora-user-images\image-20221127195210927.png)

<br>

注意：在预测过程中得到确切的结果，我们通常**对训练样本只进⾏图像增⼴**，且在**预测过程中不使⽤随机操作的图像增⼴**。同时使⽤**ToTensor实例**将⼀批图像**转换**为深度学习框架所要求的**格式**，即形状为（**批量⼤⼩，通道数，⾼度，宽度**）的**32位浮点数**，取值**范围为0到1**。

```python
train_augs = torchvision.transforms.Compose([
    torchvision.transforms.RandomHorizontalFlip(), #或其他
    torchvision.transforms.ToTensor()])

test_augs = torchvision.transforms.Compose([
	torchvision.transforms.ToTensor()])
```

<br>

#### 微调

1.迁移学习：

（1）背景：训练样本数量有限，训练模型的准确性可能⽆法满 ⾜实际要。

（2）迁移学习（transfer learning）将**从源数据集学到的知识迁移到⽬标数据集**。例如：尽管ImageNet数据集中的⼤多数**图像与椅⼦⽆关**，但在此数据集上**训练的模型可能会提取更通⽤的图像特征**， 这**有助于识别边缘、纹理、形状和对象组合**。这些类似的特征也**可能**有效地识别椅⼦。

2.微调（迁移学习的常见技巧）

<br>

#### 目标检测（object detection）或⽬标识别（object recognition）、边界框

##### 1.概念：

对于图像中感兴趣的目标，不仅想知道它们的**类别**，还想得到它们在图像中的**具体位置**。

##### 2.边界框

（1）通常使⽤边界框（bounding box）来描述对象的**空间位置**。边界框是矩形的，由矩形左上⻆的以及右下⻆的x和y坐标决定。另⼀种常⽤的边界框表⽰⽅法是边界框中⼼的(x, y)轴坐标以及框的宽 度和⾼度。

##### （2）图像中坐标的原点是图像的左上⻆，向右的⽅向为x轴的 正⽅向，向下的⽅向为y轴的正⽅向。

搁置......

<br>

### 语义分割

##### 1.概念：

语义分割重点关注于如何将图像分割成属于**不同语义类别的区域**。 与⽬标检测不同，语义分割可以识别并理解图像中每⼀个像素的内容：其**语义区域的标注和预测是像素级的**。 与⽬标检测相⽐，语义分割标注的像素级的边框 显然**更加精细**。

2.语义分割、图像分割、实例分割区别

（1）**图像分割**将图像划分为**若⼲组成区域**，这类问题的⽅法**通常利⽤图像中像素之间的相关性**。它在**训练 时不需要有关图像像素的标签信息**，在预测时也**⽆法保证**分割出的区域具有我们希望得到的语义。

（2）**实例分割**也叫**同时检测并分割**（simultaneous detection and segmentation），它研究如何识别图像中 各个⽬标实例的像素级区域。与语义分割不同，实例分割**不仅需要区分语义（类别），还要区分不同的⽬标实例（不同个体）。**例如，如果图像中有两条狗，则实例分割需要区分像素属于的两条狗中的哪⼀条。



⭐tips：

1.pycharm无法成功显示图像

```python
d2l.plt.imshow(img)
d2l.plt.show()      #额外加上。为了显示图像
```

2.os.path.join无法找到去检测文件名

